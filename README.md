# net_analysis

Detect interesting network activity generated by sandboxed bots or malware samples. The tool ingests live interfaces or PCAP captures, groups traffic into time windows, and logs alerts when configured thresholds are exceeded.

## Features
- Sliding time window analysis with configurable duration.
- Packet-rate and destination IP diversity thresholds for pinpointing suspicious bursts or scans.
- Structured logging to stdout or a JSON file, including alert metadata and window timestamps.
- Signal handling to gracefully stop live captures.

## Usage

```bash
go run . <input> <src_ip> [flags]
```

- `<input>`: Interface name for live capture or path to a `.pcap` file.
- `<src_ip>`: IP address assigned to the sandboxed bot under observation.

### Common Flags

| Flag | Description | Default |
|------|-------------|---------|
| `--output` | JSON log file path (stdout if omitted). | _None_ |
| `--window` | Analysis window size in seconds. | `30` |
| `--packet-threshold` | Packets per window that trigger an alert. | `5` |
| `--ip-threshold` | Unique destination IPs per window that trigger a scan alert. | `10` |
| `--log-level` | Logging verbosity (`debug`, `info`, `warn`, `error`). | `debug` |

## Alert Semantics

Each window is logged with `type=event`, while suspicious activity raises `type=alert`. Alert entries include:
- `timestamp`: Start of the window that triggered the alert.
- `sourceIP`: Sandbox source.
- `destinationIPs`: Unique destinations contacted in the window.
- Threshold values and measured rates to aid triage.

## Development

Run the Go module tests with:

```bash
go test ./...
```

Set the `--log-level` flag to `debug` for deeper insight into window handling and packet flow while developing or troubleshooting.
